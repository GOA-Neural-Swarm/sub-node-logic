name: Cluster Sub-node Sync
on:
  schedule:
    - cron: '*/15 * * * *' # áá… á€™á€­á€”á€…á€ºá€á€…á€ºá€á€« á€¡á€œá€­á€¯á€¡á€œá€»á€±á€¬á€€á€º á€•á€½á€¬á€¸/á€…á€…á€ºá€†á€±á€¸á€™á€Šá€º
  workflow_dispatch:      # Manual á€”á€¾á€­á€¯á€¸á€á€»á€„á€ºá€›á€„á€ºá€œá€Šá€ºá€¸ á€›á€á€Šá€º

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'

      # ğŸ› ï¸ Dependencies á€¡á€¬á€¸á€œá€¯á€¶á€¸á€€á€­á€¯ Match á€–á€¼á€…á€ºá€¡á€±á€¬á€„á€º á€á€½á€„á€ºá€¸á€á€¼á€„á€ºá€¸
      - name: Install Dependencies
        run: npm install @octokit/rest firebase-admin axios @supabase/supabase-js pg

      # ğŸš€ Swarm Logic á€€á€­á€¯ á€œá€­á€¯á€¡á€•á€ºá€á€²á€· Environment Variables á€¡á€¬á€¸á€œá€¯á€¶á€¸á€”á€²á€· Run á€á€¼á€„á€ºá€¸
      - name: Execute Swarm Logic
        run: node cluster_sync.js
        env:
          GH_TOKEN: ${{ secrets.GH_TOKEN }}
          FIREBASE_KEY: ${{ secrets.FIREBASE_KEY }}
          NEON_KEY: ${{ secrets.NEON_KEY }}
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_SERVICE_ROLE_KEY: ${{ secrets.SUPABASE_SERVICE_ROLE_KEY }}
