name: Cluster Sub-node Sync

on:
  schedule:
    - cron: '*/15 * * * *' # áá… á€™á€­á€”á€…á€ºá€á€…á€ºá€á€« á€¡á€œá€­á€¯á€¡á€œá€»á€±á€¬á€€á€º á€•á€½á€¬á€¸/á€…á€…á€ºá€†á€±á€¸á€™á€Šá€º
  workflow_dispatch:      # Manual á€”á€¾á€­á€¯á€¸á€á€»á€„á€ºá€›á€„á€ºá€œá€Šá€ºá€¸ á€›á€á€Šá€º

permissions:
  contents: write
  pages: write
  id-token: write
  actions: write

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository Code
        uses: actions/checkout@v4

      - name: Setup Node.js Environment
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      # ğŸ”± á€™á€„á€ºá€¸á€›á€²á€· delta_sync.js á€”á€²á€· cluster_sync.js á€‘á€²á€€ libraries á€¡á€¬á€¸á€œá€¯á€¶á€¸á€€á€­á€¯ Match á€œá€¯á€•á€ºá€á€¼á€„á€ºá€¸
      - name: Install All Neural Dependencies
        run: |
          npm init -y
          npm install @octokit/rest firebase-admin axios @supabase/supabase-js pg
          echo "âœ… Trinity Modules (axios, pg, supabase, firebase) Installed."

      # ğŸš€ á€™á€„á€ºá€¸á€•á€±á€¸á€‘á€¬á€¸á€á€²á€· delta_sync.js á€€á€­á€¯ Run á€á€¼á€„á€ºá€¸
      # (á€™á€¾á€á€ºá€á€»á€€á€º: á€–á€­á€¯á€„á€ºá€”á€¬á€™á€Šá€ºá€€ delta_sync.js á€–á€¼á€…á€ºá€›á€•á€«á€™á€šá€º)
      - name: Execute Swarm Logic (Main)
        run: node delta_sync.js
        env:
          # Database & Firebase Keys
          NEON_KEY: ${{ secrets.NEON_KEY }}
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_SERVICE_ROLE_KEY: ${{ secrets.SUPABASE_SERVICE_ROLE_KEY }}
          FIREBASE_KEY: ${{ secrets.FIREBASE_KEY }}

          # GitHub Authentication
          GH_TOKEN: ${{ secrets.GH_TOKEN }}
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}

# [Natural Order] System Status: Redpill Synchronized ğŸ”±
